<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8">
<link href="coqdoc.css" rel="stylesheet" type="text/css">
<script type="text/javascript" src="jquery-3.5.1.js"></script>
<script type="text/javascript" src="main.js"></script>
<script type="text/javascript" src="MyStyles.js"></script>
</head>
<h1 class="libtitle">O2: Podstawy analizy numerycznej</h1>

<div class="code">
</div>

<div class="doc">

<div class="paragraph"> </div>

 Podwaliny pod analizę numeryczną w Coqu, wzięte z
    https://www.brianheinold.net/numerical/
    An_Intuitive_Guide_to_Numerical_Methods_Heinold.pdf

</div>
<div class="code">

<br/>
<span class="id" title="keyword">Require</span> <span class="id" title="keyword">Import</span> <span class="id" title="var">Floats</span>.<br/>

<br/>
<span class="id" title="keyword">Open</span> <span class="id" title="keyword">Scope</span> <span class="id" title="var">float</span>.<br/>

<br/>
<span class="id" title="keyword">Require</span> <span class="id" title="keyword">Import</span> <span class="id" title="var">List</span>.<br/>
<span class="id" title="keyword">Import</span> <span class="id" title="var">ListNotations</span>.<br/>

<br/>
<span class="id" title="keyword">Unset</span> <span class="id" title="var">Guard</span> <span class="id" title="var">Checking</span>.<br/>

<br/>
</div>

<div class="doc">
<a id="lab835"></a><h1 class="section">1 Introductory material</h1>

</div>
<div class="code">

<br/>
<span class="id" title="keyword">Fixpoint</span> <span class="id" title="var">root2_aux</span> (<span class="id" title="var">r</span> <span class="id" title="var">x</span> : <span class="id" title="var">float</span>) (<span class="id" title="var">n</span> : <span class="id" title="var">nat</span>) : <span class="id" title="var">float</span> :=<br/>
<span class="id" title="keyword">match</span> <span class="id" title="var">n</span> <span class="id" title="keyword">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;| 0 =&gt; <span class="id" title="var">r</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id" title="var">S</span> <span class="id" title="var">n'</span> =&gt; <span class="id" title="var">root2_aux</span> ((<span class="id" title="var">r</span> + <span class="id" title="var">x</span> / <span class="id" title="var">r</span>) / 2) <span class="id" title="var">x</span> <span class="id" title="var">n'</span><br/>
<span class="id" title="keyword">end</span>.<br/>

<br/>
<span class="id" title="keyword">Compute</span> <span class="id" title="var">map</span> (<span class="id" title="var">root2_aux</span> 1 1000) [0; 1; 2; 3; 4; 5; 6; 7]%<span class="id" title="var">nat</span>.<br/>
<span class="id" title="keyword">Compute</span> <span class="id" title="var">map</span> (<span class="id" title="var">root2_aux</span> 10 1000) [0; 1; 2; 3; 4; 5; 6; 7]%<span class="id" title="var">nat</span>.<br/>

<br/>
<span class="id" title="keyword">Definition</span> <span class="id" title="var">root</span> (<span class="id" title="var">x</span> : <span class="id" title="var">float</span>) : <span class="id" title="var">float</span> := <span class="id" title="var">root2_aux</span> (<span class="id" title="var">x</span> / 10) <span class="id" title="var">x</span> 50.<br/>

<br/>
<span class="id" title="keyword">Compute</span> <span class="id" title="var">map</span> <span class="id" title="var">root</span> [0; 1; 2; 3; 4; 5; 6; 7; 8; 9; 10; 1<span class="id" title="var">e6</span>; 1<span class="id" title="var">e12</span>].<br/>

<br/>
<span class="id" title="keyword">Compute</span> 0.1 + 0.2.<br/>

<br/>
<span class="id" title="keyword">Compute</span> (1.000000000000001 - 1) * 100000000000000.<br/>

<br/>
</div>

<div class="doc">
<a id="lab836"></a><h1 class="section">2.1 The bisection method</h1>

</div>
<div class="code">

<br/>
<span class="id" title="keyword">Fixpoint</span> <span class="id" title="var">bisect</span> (<span class="id" title="var">f</span> : <span class="id" title="var">float</span> -&gt; <span class="id" title="var">float</span>) (<span class="id" title="var">a</span> <span class="id" title="var">b</span> : <span class="id" title="var">float</span>) (<span class="id" title="var">n</span> : <span class="id" title="var">nat</span>) : <span class="id" title="var">float</span> :=<br/>
<span class="id" title="keyword">match</span> <span class="id" title="var">n</span> <span class="id" title="keyword">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;| 0 =&gt; (<span class="id" title="var">a</span> + <span class="id" title="var">b</span>) / 2<br/>
&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id" title="var">S</span> <span class="id" title="var">n'</span> =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">let</span> <span class="id" title="var">m</span> := (<span class="id" title="var">a</span> + <span class="id" title="var">b</span>) / 2 <span class="id" title="tactic">in</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">if</span> <span class="id" title="var">f</span> <span class="id" title="var">a</span> * <span class="id" title="var">f</span> <span class="id" title="var">m</span> &lt; 0<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">then</span> <span class="id" title="var">bisect</span> <span class="id" title="var">f</span> <span class="id" title="var">a</span> <span class="id" title="var">m</span> <span class="id" title="var">n'</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">else</span> <span class="id" title="var">bisect</span> <span class="id" title="var">f</span> <span class="id" title="var">m</span> <span class="id" title="var">b</span> <span class="id" title="var">n'</span><br/>
<span class="id" title="keyword">end</span>.<br/>

<br/>
<span class="id" title="keyword">Definition</span> <span class="id" title="var">f0</span> (<span class="id" title="var">x</span> : <span class="id" title="var">float</span>) : <span class="id" title="var">float</span> := 1 - 2 * <span class="id" title="var">x</span> - <span class="id" title="var">x</span> * <span class="id" title="var">x</span> * <span class="id" title="var">x</span> * <span class="id" title="var">x</span> * <span class="id" title="var">x</span>.<br/>

<br/>
<span class="id" title="keyword">Fixpoint</span> <span class="id" title="var">fast_bisect</span><br/>
&nbsp;&nbsp;(<span class="id" title="var">f</span> : <span class="id" title="var">float</span> -&gt; <span class="id" title="var">float</span>) (<span class="id" title="var">a</span> <span class="id" title="var">b</span> : <span class="id" title="var">float</span>) (<span class="id" title="var">n</span> : <span class="id" title="var">nat</span>) : <span class="id" title="var">float</span> :=<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">let</span> <span class="id" title="var">m</span> := (<span class="id" title="var">a</span> * <span class="id" title="var">f</span> <span class="id" title="var">b</span> - <span class="id" title="var">b</span> * <span class="id" title="var">f</span> <span class="id" title="var">a</span>) / (<span class="id" title="var">f</span> <span class="id" title="var">b</span> - <span class="id" title="var">f</span> <span class="id" title="var">a</span>) <span class="id" title="tactic">in</span><br/>
<span class="id" title="keyword">match</span> <span class="id" title="var">n</span> <span class="id" title="keyword">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;| 0 =&gt; <span class="id" title="var">m</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id" title="var">S</span> <span class="id" title="var">n'</span> =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">if</span> <span class="id" title="var">f</span> <span class="id" title="var">a</span> * <span class="id" title="var">f</span> <span class="id" title="var">m</span> &lt; 0<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">then</span> <span class="id" title="var">bisect</span> <span class="id" title="var">f</span> <span class="id" title="var">a</span> <span class="id" title="var">m</span> <span class="id" title="var">n'</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">else</span> <span class="id" title="var">bisect</span> <span class="id" title="var">f</span> <span class="id" title="var">m</span> <span class="id" title="var">b</span> <span class="id" title="var">n'</span><br/>
<span class="id" title="keyword">end</span>.<br/>

<br/>
<span class="id" title="keyword">Compute</span> <span class="id" title="var">f0</span> 0.<br/>
<span class="id" title="keyword">Compute</span> <span class="id" title="var">f0</span> 1.<br/>

<br/>
<span class="id" title="keyword">Compute</span> <span class="id" title="var">map</span> (<span class="id" title="var">bisect</span> <span class="id" title="var">f0</span> 1 0) [0; 1; 2; 3; 4; 40]%<span class="id" title="var">nat</span>.<br/>
<span class="id" title="keyword">Compute</span> <span class="id" title="var">map</span> <span class="id" title="var">f0</span> (<span class="id" title="var">map</span> (<span class="id" title="var">bisect</span> <span class="id" title="var">f0</span> 1 0) [0; 1; 2; 3; 4; 40]%<span class="id" title="var">nat</span>).<br/>
<span class="id" title="keyword">Compute</span> <span class="id" title="var">map</span> (<span class="id" title="var">fast_bisect</span> <span class="id" title="var">f0</span> 1 0) [0; 1; 2; 3; 4; 40]%<span class="id" title="var">nat</span>.<br/>
<span class="id" title="keyword">Compute</span> <span class="id" title="var">map</span> <span class="id" title="var">f0</span> (<span class="id" title="var">map</span> (<span class="id" title="var">fast_bisect</span> <span class="id" title="var">f0</span> 1 0) [0; 1; 2; 3; 4; 40]%<span class="id" title="var">nat</span>).<br/>

<br/>
<span class="comment">(*&nbsp;**&nbsp;2.2&nbsp;Fixed&nbsp;point&nbsp;iteration&nbsp;*)</span><br/>

<br/>
<span class="id" title="keyword">Fixpoint</span> <span class="id" title="var">iterf</span> (<span class="id" title="var">f</span> : <span class="id" title="var">float</span> -&gt; <span class="id" title="var">float</span>) (<span class="id" title="var">x</span> : <span class="id" title="var">float</span>) (<span class="id" title="var">n</span> : <span class="id" title="var">nat</span>) : <span class="id" title="var">float</span> :=<br/>
<span class="id" title="keyword">match</span> <span class="id" title="var">n</span> <span class="id" title="keyword">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;| 0 =&gt; <span class="id" title="var">x</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id" title="var">S</span> <span class="id" title="var">n'</span> =&gt; <span class="id" title="var">iterf</span> <span class="id" title="var">f</span> (<span class="id" title="var">f</span> <span class="id" title="var">x</span>) <span class="id" title="var">n'</span><br/>
<span class="id" title="keyword">end</span>.<br/>

<br/>
<span class="id" title="keyword">Definition</span> <span class="id" title="var">f1</span> (<span class="id" title="var">x</span> : <span class="id" title="var">float</span>) : <span class="id" title="var">float</span> := (1 - <span class="id" title="var">x</span> * <span class="id" title="var">x</span> * <span class="id" title="var">x</span> * <span class="id" title="var">x</span> * <span class="id" title="var">x</span>) / 2.<br/>

<br/>
<span class="id" title="keyword">Compute</span> <span class="id" title="var">map</span> (<span class="id" title="var">iterf</span> <span class="id" title="var">f1</span> 0) [0; 1; 2; 3; 4; 40]%<span class="id" title="var">nat</span>.<br/>
<span class="id" title="keyword">Compute</span> <span class="id" title="var">map</span> <span class="id" title="var">f0</span> (<span class="id" title="var">map</span> (<span class="id" title="var">iterf</span> <span class="id" title="var">f1</span> 0) [0; 1; 2; 3; 4; 40]%<span class="id" title="var">nat</span>).<br/>

<br/>
</div>

<div class="doc">
<a id="lab837"></a><h1 class="section">Pochodna</h1>

</div>
<div class="code">

<br/>
<span class="id" title="keyword">Definition</span> <span class="id" title="var">fdiff</span> (<span class="id" title="var">h</span> : <span class="id" title="var">float</span>) (<span class="id" title="var">f</span> : <span class="id" title="var">float</span> -&gt; <span class="id" title="var">float</span>) (<span class="id" title="var">x</span> : <span class="id" title="var">float</span>) : <span class="id" title="var">float</span> :=<br/>
&nbsp;&nbsp;(<span class="id" title="var">f</span> (<span class="id" title="var">x</span> + <span class="id" title="var">h</span>) - <span class="id" title="var">f</span> <span class="id" title="var">x</span>) / <span class="id" title="var">h</span>.<br/>

<br/>
<span class="id" title="keyword">Definition</span> <span class="id" title="var">bdiff</span> (<span class="id" title="var">h</span> : <span class="id" title="var">float</span>) (<span class="id" title="var">f</span> : <span class="id" title="var">float</span> -&gt; <span class="id" title="var">float</span>) (<span class="id" title="var">x</span> : <span class="id" title="var">float</span>) : <span class="id" title="var">float</span> :=<br/>
&nbsp;&nbsp;(<span class="id" title="var">f</span> <span class="id" title="var">x</span> - <span class="id" title="var">f</span> (<span class="id" title="var">x</span> - <span class="id" title="var">h</span>)) / <span class="id" title="var">h</span>.<br/>

<br/>
<span class="id" title="keyword">Definition</span> <span class="id" title="var">cdiff</span> (<span class="id" title="var">h</span> : <span class="id" title="var">float</span>) (<span class="id" title="var">f</span> : <span class="id" title="var">float</span> -&gt; <span class="id" title="var">float</span>) (<span class="id" title="var">x</span> : <span class="id" title="var">float</span>) : <span class="id" title="var">float</span> :=<br/>
&nbsp;&nbsp;(<span class="id" title="var">f</span> (<span class="id" title="var">x</span> + <span class="id" title="var">h</span>) - <span class="id" title="var">f</span> (<span class="id" title="var">x</span> - <span class="id" title="var">h</span>)) / (2 * <span class="id" title="var">h</span>).<br/>

<br/>
<span class="id" title="keyword">Definition</span> <span class="id" title="var">f2</span> (<span class="id" title="var">x</span> : <span class="id" title="var">float</span>) : <span class="id" title="var">float</span> := <span class="id" title="var">x</span> * <span class="id" title="var">x</span>.<br/>

<br/>
<span class="id" title="keyword">Definition</span> <span class="id" title="var">hs</span> : <span class="id" title="var">list</span> <span class="id" title="var">float</span> :=<br/>
&nbsp;&nbsp;[1; 1<span class="id" title="var">e</span>-1; 1<span class="id" title="var">e</span>-2; 1<span class="id" title="var">e</span>-3; 1<span class="id" title="var">e</span>-4; 1<span class="id" title="var">e</span>-5; 1<span class="id" title="var">e</span>-6; 1<span class="id" title="var">e</span>-7; 1<span class="id" title="var">e</span>-8; 1<span class="id" title="var">e</span>-9; 1<span class="id" title="var">e</span>-10;<br/>
&nbsp;&nbsp;&nbsp;1<span class="id" title="var">e</span>-11; 1<span class="id" title="var">e</span>-12; 1<span class="id" title="var">e</span>-13; 1<span class="id" title="var">e</span>-14; 1<span class="id" title="var">e</span>-15; 1<span class="id" title="var">e</span>-16].<br/>

<br/>
<span class="id" title="keyword">Compute</span> <span class="id" title="var">map</span> (<span class="id" title="keyword">fun</span> <span class="id" title="var">h</span> =&gt; <span class="id" title="var">fdiff</span> <span class="id" title="var">h</span> <span class="id" title="var">f2</span> 1) <span class="id" title="var">hs</span>.<br/>
<span class="id" title="keyword">Compute</span> <span class="id" title="var">map</span> (<span class="id" title="keyword">fun</span> <span class="id" title="var">h</span> =&gt; <span class="id" title="var">bdiff</span> <span class="id" title="var">h</span> <span class="id" title="var">f2</span> 1) <span class="id" title="var">hs</span>.<br/>
<span class="id" title="keyword">Compute</span> <span class="id" title="var">map</span> (<span class="id" title="keyword">fun</span> <span class="id" title="var">h</span> =&gt; <span class="id" title="var">cdiff</span> <span class="id" title="var">h</span> <span class="id" title="var">f2</span> 1) <span class="id" title="var">hs</span>.<br/>

<br/>
</div>

<div class="doc">
<a id="lab838"></a><h1 class="section">2.3 Newton's method</h1>

</div>
<div class="code">

<br/>
<span class="id" title="keyword">Fixpoint</span> <span class="id" title="var">Newton</span><br/>
&nbsp;&nbsp;(<span class="id" title="var">h</span> : <span class="id" title="var">float</span>) (<span class="id" title="var">f</span> : <span class="id" title="var">float</span> -&gt; <span class="id" title="var">float</span>) (<span class="id" title="var">x0</span> : <span class="id" title="var">float</span>) (<span class="id" title="var">n</span> : <span class="id" title="var">nat</span>) : <span class="id" title="var">float</span> :=<br/>
<span class="id" title="keyword">match</span> <span class="id" title="var">n</span> <span class="id" title="keyword">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;| 0 =&gt; <span class="id" title="var">x0</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id" title="var">S</span> <span class="id" title="var">n'</span> =&gt; <span class="id" title="var">Newton</span> <span class="id" title="var">h</span> <span class="id" title="var">f</span> (<span class="id" title="var">x0</span> - <span class="id" title="var">f</span> <span class="id" title="var">x0</span> / <span class="id" title="var">cdiff</span> <span class="id" title="var">h</span> <span class="id" title="var">f</span> <span class="id" title="var">x0</span>) <span class="id" title="var">n'</span><br/>
<span class="id" title="keyword">end</span>.<br/>

<br/>
<span class="id" title="keyword">Fixpoint</span> <span class="id" title="var">Newton'</span><br/>
&nbsp;&nbsp;(<span class="id" title="var">h</span> : <span class="id" title="var">float</span>) (<span class="id" title="var">f</span> <span class="id" title="var">f'</span> : <span class="id" title="var">float</span> -&gt; <span class="id" title="var">float</span>) (<span class="id" title="var">x</span> : <span class="id" title="var">float</span>) (<span class="id" title="var">n</span> : <span class="id" title="var">nat</span>) : <span class="id" title="var">float</span> :=<br/>
<span class="id" title="keyword">match</span> <span class="id" title="var">n</span> <span class="id" title="keyword">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;| 0 =&gt; <span class="id" title="var">x</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id" title="var">S</span> <span class="id" title="var">n'</span> =&gt; <span class="id" title="var">Newton'</span> <span class="id" title="var">h</span> <span class="id" title="var">f</span> <span class="id" title="var">f'</span> (<span class="id" title="var">x</span> - <span class="id" title="var">f</span> <span class="id" title="var">x</span> / <span class="id" title="var">f'</span> <span class="id" title="var">x</span>) <span class="id" title="var">n'</span><br/>
<span class="id" title="keyword">end</span>.<br/>

<br/>
<span class="id" title="keyword">Compute</span> <span class="id" title="var">map</span> (<span class="id" title="var">Newton</span> 1<span class="id" title="var">e</span>-5 <span class="id" title="var">f2</span> 2) [0; 1; 2; 3; 4; 5; 6; 7]%<span class="id" title="var">nat</span>.<br/>

<br/>
<span class="id" title="keyword">Definition</span> <span class="id" title="var">f3</span> (<span class="id" title="var">x</span> : <span class="id" title="var">float</span>) : <span class="id" title="var">float</span> := <span class="id" title="var">x</span> * <span class="id" title="var">x</span> - 2.<br/>

<br/>
<span class="id" title="keyword">Compute</span> <span class="id" title="var">map</span> (<span class="id" title="var">Newton</span> 1<span class="id" title="var">e</span>-5 <span class="id" title="var">f3</span> 2) [0; 1; 2; 3; 4; 5; 6; 7]%<span class="id" title="var">nat</span>.<br/>
<span class="id" title="keyword">Compute</span> <span class="id" title="var">map</span> <span class="id" title="var">f3</span> (<span class="id" title="var">map</span> (<span class="id" title="var">Newton</span> 1<span class="id" title="var">e</span>-5 <span class="id" title="var">f3</span> 2) [0; 1; 2; 3; 4; 5; 6; 7]%<span class="id" title="var">nat</span>).<br/>

<br/>
<span class="id" title="keyword">Compute</span> <span class="id" title="var">map</span> (<span class="id" title="var">Newton'</span> 1<span class="id" title="var">e</span>-5 <span class="id" title="var">f3</span> (<span class="id" title="keyword">fun</span> <span class="id" title="var">x</span> =&gt; 2 * <span class="id" title="var">x</span>) 2) [0; 1; 2; 3; 4; 5; 6; 7]%<span class="id" title="var">nat</span>.<br/>
<span class="id" title="keyword">Compute</span> <span class="id" title="var">map</span> <span class="id" title="var">f3</span> (<span class="id" title="var">map</span> (<span class="id" title="var">Newton</span> 1<span class="id" title="var">e</span>-5 <span class="id" title="var">f3</span> 2) [0; 1; 2; 3; 4; 5; 6; 7]%<span class="id" title="var">nat</span>).<br/>

<br/>
</div>

<div class="doc">
<a id="lab839"></a><h1 class="section">2.4 Rates of convergence</h1>

</div>
<div class="code">

<br/>
<span class="id" title="keyword">Fixpoint</span> <span class="id" title="var">Halley</span><br/>
&nbsp;&nbsp;(<span class="id" title="var">h</span> : <span class="id" title="var">float</span>) (<span class="id" title="var">f</span> : <span class="id" title="var">float</span> -&gt; <span class="id" title="var">float</span>) (<span class="id" title="var">x</span> : <span class="id" title="var">float</span>) (<span class="id" title="var">n</span> : <span class="id" title="var">nat</span>) : <span class="id" title="var">float</span> :=<br/>
<span class="id" title="keyword">match</span> <span class="id" title="var">n</span> <span class="id" title="keyword">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;| 0 =&gt; <span class="id" title="var">x</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id" title="var">S</span> <span class="id" title="var">n'</span> =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">let</span> <span class="id" title="var">f'</span> := <span class="id" title="var">cdiff</span> <span class="id" title="var">h</span> <span class="id" title="var">f</span> <span class="id" title="tactic">in</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">let</span> <span class="id" title="var">f''</span> := <span class="id" title="var">cdiff</span> <span class="id" title="var">h</span> <span class="id" title="var">f'</span> <span class="id" title="tactic">in</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">let</span> <span class="id" title="var">x'</span> := <span class="id" title="var">x</span> - 2 * <span class="id" title="var">f</span> <span class="id" title="var">x</span> * <span class="id" title="var">f'</span> <span class="id" title="var">x</span> / (2 * <span class="id" title="var">f'</span> <span class="id" title="var">x</span> * <span class="id" title="var">f'</span> <span class="id" title="var">x</span> - <span class="id" title="var">f</span> <span class="id" title="var">x</span> * <span class="id" title="var">f''</span> <span class="id" title="var">x</span>) <span class="id" title="tactic">in</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">Halley</span> <span class="id" title="var">h</span> <span class="id" title="var">f</span> <span class="id" title="var">x'</span> <span class="id" title="var">n'</span><br/>
<span class="id" title="keyword">end</span>.<br/>

<br/>
<span class="id" title="keyword">Definition</span> <span class="id" title="var">f4</span> (<span class="id" title="var">x</span> : <span class="id" title="var">float</span>) : <span class="id" title="var">float</span> := <span class="id" title="var">x</span> * <span class="id" title="var">x</span> * <span class="id" title="var">x</span> * <span class="id" title="var">x</span> * <span class="id" title="var">x</span> - 7 * <span class="id" title="var">x</span> * <span class="id" title="var">x</span> - 42.<br/>

<br/>
<span class="id" title="keyword">Compute</span> <span class="id" title="var">map</span> (<span class="id" title="var">Newton</span> 1<span class="id" title="var">e</span>-5 <span class="id" title="var">f4</span> 2) [0; 1; 2; 3; 4; 5; 6; 7]%<span class="id" title="var">nat</span>.<br/>
<span class="id" title="keyword">Compute</span> <span class="id" title="var">map</span> <span class="id" title="var">f4</span> (<span class="id" title="var">map</span> (<span class="id" title="var">Newton</span> 1<span class="id" title="var">e</span>-5 <span class="id" title="var">f4</span> 2) [0; 1; 2; 3; 4; 5; 6; 7]%<span class="id" title="var">nat</span>).<br/>

<br/>
<span class="id" title="keyword">Compute</span> <span class="id" title="var">map</span> (<span class="id" title="var">Halley</span> 1<span class="id" title="var">e</span>-5 <span class="id" title="var">f4</span> 2) [0; 1; 2; 3; 4; 5; 6; 7]%<span class="id" title="var">nat</span>.<br/>
<span class="id" title="keyword">Compute</span> <span class="id" title="var">map</span> <span class="id" title="var">f4</span> (<span class="id" title="var">map</span> (<span class="id" title="var">Halley</span> 1<span class="id" title="var">e</span>-5 <span class="id" title="var">f4</span> 2) [0; 1; 2; 3; 4; 5; 6; 7]%<span class="id" title="var">nat</span>).<br/>

<br/>
</div>

<div class="doc">
<a id="lab840"></a><h1 class="section">2.5 Secant method</h1>

</div>
<div class="code">

<br/>
<span class="id" title="keyword">Fixpoint</span> <span class="id" title="var">secant</span><br/>
&nbsp;&nbsp;(<span class="id" title="var">h</span> : <span class="id" title="var">float</span>) (<span class="id" title="var">f</span> : <span class="id" title="var">float</span> -&gt; <span class="id" title="var">float</span>) (<span class="id" title="var">a</span> <span class="id" title="var">b</span> : <span class="id" title="var">float</span>) (<span class="id" title="var">n</span> : <span class="id" title="var">nat</span>) : <span class="id" title="var">float</span> :=<br/>
<span class="id" title="keyword">match</span> <span class="id" title="var">n</span> <span class="id" title="keyword">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;| 0 =&gt; <span class="id" title="var">a</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id" title="var">S</span> <span class="id" title="var">n'</span> =&gt; <span class="id" title="var">secant</span> <span class="id" title="var">h</span> <span class="id" title="var">f</span> <span class="id" title="var">b</span> (<span class="id" title="var">b</span> - <span class="id" title="var">f</span> <span class="id" title="var">b</span> * (<span class="id" title="var">b</span> - <span class="id" title="var">a</span>) / (<span class="id" title="var">f</span> <span class="id" title="var">b</span> - <span class="id" title="var">f</span> <span class="id" title="var">a</span>)) <span class="id" title="var">n'</span><br/>
<span class="id" title="keyword">end</span>.<br/>

<br/>
<span class="id" title="keyword">Compute</span> <span class="id" title="var">map</span> (<span class="id" title="var">Newton</span> 1<span class="id" title="var">e</span>-5 <span class="id" title="var">f3</span> 2) [0; 1; 2; 3; 4; 5; 6; 7]%<span class="id" title="var">nat</span>.<br/>
<span class="id" title="keyword">Compute</span> <span class="id" title="var">map</span> <span class="id" title="var">f3</span> (<span class="id" title="var">map</span> (<span class="id" title="var">Newton</span> 1<span class="id" title="var">e</span>-5 <span class="id" title="var">f3</span> 2) [0; 1; 2; 3; 4; 5; 6; 7]%<span class="id" title="var">nat</span>).<br/>
<span class="id" title="keyword">Compute</span> <span class="id" title="var">map</span> (<span class="id" title="var">secant</span> 1<span class="id" title="var">e</span>-5 <span class="id" title="var">f3</span> 0 1) [0; 1; 2; 3; 4; 5; 6; 7]%<span class="id" title="var">nat</span>.<br/>
<span class="id" title="keyword">Compute</span> <span class="id" title="var">map</span> <span class="id" title="var">f3</span> (<span class="id" title="var">map</span> (<span class="id" title="var">secant</span> 1<span class="id" title="var">e</span>-5 <span class="id" title="var">f3</span> 0 1) [0; 1; 2; 3; 4; 5; 6; 7]%<span class="id" title="var">nat</span>).<br/>

<br/>
</div>

<div class="doc">
<a id="lab841"></a><h1 class="section">2.7 Some more details on root-finding</h1>

</div>
<div class="code">

<br/>
<span class="id" title="keyword">Definition</span> <span class="id" title="var">aitken</span> (<span class="id" title="var">x</span> : <span class="id" title="var">nat</span> -&gt; <span class="id" title="var">float</span>) (<span class="id" title="var">n</span> : <span class="id" title="var">nat</span>) : <span class="id" title="var">float</span> :=<br/>
&nbsp;&nbsp;<span class="id" title="keyword">let</span> <span class="id" title="var">a</span> := <span class="id" title="var">x</span> (1 + <span class="id" title="var">n</span>)%<span class="id" title="var">nat</span> - <span class="id" title="var">x</span> <span class="id" title="var">n</span> <span class="id" title="tactic">in</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">x</span> <span class="id" title="var">n</span> - <span class="id" title="var">a</span> * <span class="id" title="var">a</span> / (<span class="id" title="var">x</span> <span class="id" title="var">n</span> - 2 * <span class="id" title="var">x</span> (1 + <span class="id" title="var">n</span>)%<span class="id" title="var">nat</span> + <span class="id" title="var">x</span> (2 + <span class="id" title="var">n</span>)%<span class="id" title="var">nat</span>).<br/>

<br/>
<span class="id" title="keyword">Search</span> <span class="id" title="var">float</span>.<br/>

<br/>
<span class="comment">(*<br/>
Fixpoint&nbsp;es&nbsp;(x&nbsp;:&nbsp;float)&nbsp;(n&nbsp;:&nbsp;nat)&nbsp;:&nbsp;list&nbsp;float&nbsp;:=<br/>
match&nbsp;n&nbsp;with<br/>
&nbsp;&nbsp;&nbsp;&nbsp;|&nbsp;0&nbsp;=&gt;&nbsp;<span class="inlinecode"></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;|&nbsp;S&nbsp;n'&nbsp;=&gt;&nbsp;x&nbsp;:&nbsp;es&nbsp;(exp&nbsp;x)&nbsp;n'<br/>
end.<br/>
*)</span></div>
